{% extends 'main.html' %}
{% load static %}

{% block static_url %}
{{ block.super }}
<link href="{% static 'css/video_generator.css' %}" rel="stylesheet">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@200;300;400;500;600;700;800&display=swap" rel="stylesheet">
{% endblock %}

{% block body_content %}  
<div class="container">
  <div class="subscription-info">
    <div class="plan-badge {{ subscription_status|lower }}">{{ subscription_status }} Plan</div>
    <div class="usage-info">
      <div class="usage-text">Videos Generated: {{ videos_generated }} of {{ videos_limit }} this month ({{ percentage_used|floatformat:0 }}%)</div>
      <div class="usage-bar">
        <div class="usage-progress" id="usage-progress-bar"></div>
      </div>
    </div>
    <div class="stats">
      <span class="total-stats">Total Videos: {{ total_videos_generated }}</span>
    </div>
    {% if not can_generate %}
    <div class="limit-warning">
      You've reached your monthly limit. <a href="{% url 'pricing' %}">Upgrade your plan</a> to generate more videos.
    </div>
    {% endif %}
  </div>
  
  <div class="wraper">
    <div class="left-container">
      <!-- Tab Navigation -->
      <div class="head">
        <p class="active_p" id="text-btn" data-tab="text-tab">Text</p>
        <p id="image-btn" data-tab="image-tab">Image</p>
        <p id="audio-btn" data-tab="audio-tab">Audio</p>
        <p id="captions-btn" data-tab="captions-tab">Captions</p>
        <p id="setting-btn" data-tab="settings-tab">Settings</p>
      </div>

      <!-- Card Area for Tab Content -->
      <div class="card_area">
        <!-- TEXT TAB -->
        <div id="text-tab" class="tab-pane active">
          <div class="form-inputs">
            <div class="form-row">
              <div class="form-column">
                <label class="form-label">Niche/Topic:</label>
                <input type="text" id="niche" name="niche" placeholder="e.g., Fitness, Technology, Finance" class="form-input">
              </div>
              <div class="form-column">
                <label class="form-label">Language:</label>
                <select id="language" name="language" class="form-select">
                  <option value="en">English</option>
                  <option value="es">Spanish</option>
                  <option value="fr">French</option>
                  <option value="de">German</option>
                  <option value="it">Italian</option>
                  <option value="pt">Portuguese</option>
                  <option value="ru">Russian</option>
                  <option value="zh">Chinese</option>
                  <option value="ja">Japanese</option>
                  <option value="ko">Korean</option>
                  <option value="ar">Arabic</option>
                  <option value="hi">Hindi</option>
                </select>
              </div>
            </div>
            
            <div class="form-row">
              <div class="form-column">
                <label class="form-label">Text Generator:</label>
                <select id="text-gen" name="text_gen" class="form-select">
                  {% for generator in text_generators %}
                    <option value="{{ generator }}">{{ generator|title }}</option>
                  {% endfor %}
                </select>
              </div>
              <div class="form-column">
                <label class="form-label">Model:</label>
                <select id="text-model" name="text_model" class="form-select">
                  {% for model in text_models %}
                    <option value="{{ model }}">{{ model|title }}</option>
                  {% endfor %}
                </select>
              </div>
            </div>
            
            <div class="output-sections">
              <div class="output-section">
                <div class="output-header" onclick="toggleCollapsible(this)">
                  <span>Generated Topic</span>
                  <span class="toggle-icon">▼</span>
                </div>
                <div class="output-content">
                  <div id="generated-topic" class="output-box">Generated topic will appear here</div>
                </div>
              </div>
              
              <div class="output-section">
                <div class="output-header" onclick="toggleCollapsible(this)">
                  <span>Script</span>
                  <span class="toggle-icon">▼</span>
                </div>
                <div class="output-content">
                  <div id="generated-script" class="output-box script-box">Generated script will appear here</div>
                </div>
              </div>
              
              <div class="output-section">
                <div class="output-header" onclick="toggleCollapsible(this)">
                  <span>Image Prompts</span>
                  <span class="toggle-icon">▼</span>
                </div>
                <div class="output-content">
                  <div id="image-prompts" class="output-box">Generated image prompts will appear here</div>
                </div>
              </div>
              
              <div class="output-section">
                <div class="output-header" onclick="toggleCollapsible(this)">
                  <span>Metadata</span>
                  <span class="toggle-icon">▼</span>
                </div>
                <div class="output-content">
                  <div id="metadata" class="output-box">
                    <div id="video-title" class="metadata-title">Generated title will appear here</div>
                    <div id="video-description">Generated description will appear here</div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- IMAGE TAB -->
        <div id="image-tab" class="tab-pane">
          <div class="form-inputs">
            <div class="form-row">
              <div class="form-column">
                <label class="form-label">Image Generator:</label>
                <select id="image-gen" name="image_gen" class="form-select">
                  {% for generator in image_generators %}
                    <option value="{{ generator }}">{{ generator|title }}</option>
                  {% endfor %}
                </select>
              </div>
              <div class="form-column">
                <label class="form-label">Model:</label>
                <select id="image-model" name="image_model" class="form-select">
                  {% for model in image_models %}
                    <option value="{{ model }}">{{ model|title }}</option>
                  {% endfor %}
                </select>
              </div>
            </div>
            
            <div class="slider-container">
              <label class="form-label">Number of Images:</label>
              <input type="range" id="image-count" name="image_count" min="1" max="5" value="3" class="slider">
              <div class="range-value"><span id="image-count-value">3</span> images</div>
            </div>
            
            <div class="image-gallery">
              <div class="placeholder-message">
                Generated images will appear here
              </div>
            </div>
          </div>
        </div>

        <!-- AUDIO TAB -->
        <div id="audio-tab" class="tab-pane">
          <div class="form-inputs">
            <div class="form-row">
              <div class="form-column">
                <label class="form-label">Voice Engine:</label>
                <select id="tts-engine" name="tts_engine" class="form-select">
                  {% for engine in tts_engines %}
                    <option value="{{ engine }}">{{ engine|title }}</option>
                  {% endfor %}
                </select>
              </div>
              <div class="form-column">
                <label class="form-label">Voice:</label>
                <select id="tts-voice" name="tts_voice" class="form-select">
                  {% for voice in voices %}
                    <option value="{{ voice.value }}">{{ voice.name }}</option>
                  {% endfor %}
                </select>
              </div>
            </div>
            
            <div class="button-container">
              <button id="preview-voice-btn" class="secondary-btn">Preview Voice</button>
            </div>
            
            <div class="form-section">
              <label class="form-label">Background Music:</label>
              <select id="music-file" name="music_file" class="form-select">
                <option value="random">Random</option>
                <option value="none">None</option>
                {% for music in music_files %}
                  <option value="{{ music }}">{{ music }}</option>
                {% endfor %}
              </select>
              <input type="file" id="music-file-input" accept=".mp3,.wav,.ogg,.m4a" style="display: none;">
              <button type="button" id="upload-music-btn" class="secondary-btn mt-2">Upload Music</button>
            </div>
            
            <div class="slider-container">
              <label class="form-label">Music Volume: <span id="volume-value">30%</span></label>
              <input type="range" id="music-volume" name="music_volume" min="0" max="1" step="0.1" value="0.3" class="slider">
            </div>
            
            <div class="audio-preview">
              <button id="preview-music-btn" class="secondary-btn">Preview Music</button>
              <audio id="preview-audio" controls></audio>
            </div>
          </div>
        </div>

        <!-- CAPTIONS TAB -->
        <div id="captions-tab" class="tab-pane">
          <div class="form-inputs">
            <div class="checkbox-group">
              <div class="form-checkbox">
                <input type="checkbox" id="subtitle-enabled" name="subtitles_enabled" checked>
                <label for="subtitle-enabled">Show Subtitles</label>
              </div>
              <div class="form-checkbox">
                <input type="checkbox" id="highlight-enabled" name="highlighting_enabled" checked>
                <label for="highlight-enabled">Word Highlighting</label>
              </div>
            </div>
            
            <div class="form-row">
              <div class="form-column">
                <label class="form-label">Font:</label>
                <select id="subtitle-font" name="subtitle_font" class="form-select">
                  <option value="default">Default</option>
                  {% for font in font_files %}
                    <option value="{{ font }}">{{ font }}</option>
                  {% endfor %}
                </select>
                <input type="file" id="font-file-input" accept=".ttf,.otf" style="display: none;">
                <button type="button" id="upload-font-btn" class="secondary-btn mt-2">Upload Font</button>
              </div>
              <div class="form-column">
                <label class="form-label">Size:</label>
                <input type="number" id="font-size" name="font_size" min="20" max="120" value="80" class="form-input">
              </div>
            </div>
            
            <div class="form-row">
              <div class="form-column">
                <label class="form-label">Text Color:</label>
                <input type="color" id="text-color" name="text_color" value="#ffffff" class="form-input">
              </div>
              <div class="form-column">
                <label class="form-label">Highlight Color:</label>
                <input type="color" id="highlight-color" name="highlight_color" value="#0066ff" class="form-input">
              </div>
            </div>
            
            <div class="form-row">
              <div class="form-column">
                <label class="form-label">Stroke Color:</label>
                <input type="color" id="stroke-color" name="stroke_color" value="#000000" class="form-input">
              </div>
              <div class="form-column">
                <label class="form-label">Position:</label>
                <select id="subtitle-position" name="subtitle_position" class="form-select">
                  <option value="bottom">Bottom</option>
                  <option value="middle">Middle</option>
                  <option value="top">Top</option>
                </select>
              </div>
            </div>
          </div>
        </div>

        <!-- SETTINGS TAB -->
        <div id="settings-tab" class="tab-pane">
          <div class="form-inputs">
            <div class="form-checkbox">
              <input type="checkbox" id="auto-upload" name="auto_upload" checked>
              <label for="auto-upload">Auto-Upload to Connected Platforms</label>
            </div>
            
            <h3 class="section-title">Platform Connections</h3>
            <div class="platform-connections">
              <!-- YouTube -->
              <div class="platform-item">
                <div class="platform-icon">
                  <img src="{% static 'media/icons/youtube.png' %}" alt="YouTube">
                </div>
                <div class="platform-info">
                  <div class="platform-name">YouTube</div>
                  <div class="platform-status" id="youtube-status">Disconnected</div>
                </div>
                <div class="platform-buttons">
                  <button data-platform="youtube" class="connection-btn">Connect</button>
                  <button data-platform="youtube" class="auto-upload-btn">Enable Auto</button>
                </div>
              </div>
              
              <!-- TikTok -->
              <div class="platform-item">
                <div class="platform-icon">
                  <img src="{% static 'media/icons/tiktok.png' %}" alt="TikTok">
                </div>
                <div class="platform-info">
                  <div class="platform-name">TikTok</div>
                  <div class="platform-status" id="tiktok-status">Disconnected</div>
                </div>
                <div class="platform-buttons">
                  <button data-platform="tiktok" class="connection-btn">Connect</button>
                  <button data-platform="tiktok" class="auto-upload-btn">Enable Auto</button>
                </div>
              </div>
              
              <!-- Facebook -->
              <div class="platform-item">
                <div class="platform-icon">
                  <img src="{% static 'media/icons/facebook.png' %}" alt="Facebook">
                </div>
                <div class="platform-info">
                  <div class="platform-name">Facebook</div>
                  <div class="platform-status" id="facebook-status">Disconnected</div>
                </div>
                <div class="platform-buttons">
                  <button data-platform="facebook" class="connection-btn">Connect</button>
                  <button data-platform="facebook" class="auto-upload-btn">Enable Auto</button>
                </div>
              </div>
              
              <!-- Instagram -->
              <div class="platform-item">
                <div class="platform-icon">
                  <img src="{% static 'media/icons/instagram.png' %}" alt="Instagram">
                </div>
                <div class="platform-info">
                  <div class="platform-name">Instagram</div>
                  <div class="platform-status" id="instagram-status">Disconnected</div>
                </div>
                <div class="platform-buttons">
                  <button data-platform="instagram" class="connection-btn">Connect</button>
                  <button data-platform="instagram" class="auto-upload-btn">Enable Auto</button>
                </div>
              </div>
              
              <!-- Twitter -->
              <div class="platform-item">
                <div class="platform-icon">
                  <img src="{% static 'media/icons/twitter.png' %}" alt="Twitter">
                </div>
                <div class="platform-info">
                  <div class="platform-name">Twitter</div>
                  <div class="platform-status" id="twitter-status">Disconnected</div>
                </div>
                <div class="platform-buttons">
                  <button data-platform="twitter" class="connection-btn">Connect</button>
                  <button data-platform="twitter" class="auto-upload-btn">Enable Auto</button>
                </div>
              </div>
              
              <!-- Pinterest -->
              <div class="platform-item">
                <div class="platform-icon">
                  <img src="{% static 'media/icons/pinterest.png' %}" alt="Pinterest">
                </div>
                <div class="platform-info">
                  <div class="platform-name">Pinterest</div>
                  <div class="platform-status" id="pinterest-status">Disconnected</div>
                </div>
                <div class="platform-buttons">
                  <button data-platform="pinterest" class="connection-btn">Connect</button>
                  <button data-platform="pinterest" class="auto-upload-btn">Enable Auto</button>
                </div>
              </div>
              
              <!-- LinkedIn -->
              <div class="platform-item">
                <div class="platform-icon">
                  <img src="{% static 'media/icons/linkedin.png' %}" alt="LinkedIn">
                </div>
                <div class="platform-info">
                  <div class="platform-name">LinkedIn</div>
                  <div class="platform-status" id="linkedin-status">Disconnected</div>
                </div>
                <div class="platform-buttons">
                  <button data-platform="linkedin" class="connection-btn">Connect</button>
                  <button data-platform="linkedin" class="auto-upload-btn">Enable Auto</button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
        
      <!-- Generate Video Button -->
      <div class="generate-button-container">
        <button id="generate-video-btn" class="primary-btn">Generate Video</button>
        <div class="progress-container">
          <div id="progress-bar" class="progress-bar"></div>
        </div>
        <div id="progress-text" class="progress-text">0%</div>
      </div>
    </div>
      
    <div class="right-container">
      <div class="images-Portion">
        <img src="{% static 'media/image/placeholder.jpg' %}" alt="Image Preview" id="preview-image">
        <video id="video-preview" controls style="display: none;">
          <source src="" type="video/mp4">
          Your browser does not support the video tag.
        </video>
        <!-- Caption Preview & Play Button -->
        <div id="caption-preview-container" class="caption-preview-container">
          <div id="caption-preview" class="caption-preview">
            <span class="caption-text">This is a <span class="highlighted">preview</span> of your caption style</span>
          </div>
        </div>
        <div id="play-button-container" class="play-button-container">
          <div id="play-button" class="play-button">
            <span class="play-icon">▶</span>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Debug Log Section - Full Width Container -->
<div class="container">
  <div id="debug-log-container" class="debug-log-container">
    <div class="debug-log-header">
      <span>Debug Logs</span>
      <button id="toggle-logs-btn" class="toggle-logs-btn">▼</button>
    </div>
    <div id="debug-log" class="debug-log">
      <div>Initializing video generation environment...</div>
    </div>
  </div>
</div>
{% endblock %}

{% block script %}
{{ block.super }}
<script src="{% static '/js/video_generator.js' %}"></script>
{% endblock %}
 